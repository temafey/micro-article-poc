# =============================================================================
# Prometheus Scrape Configuration (TASK-037: Alerting & Profiling)
# =============================================================================
# Configures Prometheus to scrape metrics from infrastructure exporters.
# This file is mounted into the otel-lgtm container at /otel-lgtm/prometheus.yaml
#
# Related: docker-compose.observability-dev.yml
#          ADR-014-observability-stack-modernization.md
# =============================================================================

global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # Self-scrape for Prometheus metrics
  - job_name: 'prometheus'
    static_configs:
      - targets: ['127.0.0.1:9090']
        labels:
          service: 'prometheus'

  # PostgreSQL exporter metrics
  - job_name: 'postgres-exporter'
    static_configs:
      - targets: ['postgres-exporter:9187']
        labels:
          service: 'postgres'
          component: 'database'

  # Redis exporter metrics
  - job_name: 'redis-exporter'
    static_configs:
      - targets: ['redis-exporter:9121']
        labels:
          service: 'redis'
          component: 'cache'

  # OpenTelemetry Collector metrics (internal metrics from otel-lgtm)
  # This exposes span metrics generated by Tempo from traces
  - job_name: 'otel-collector'
    static_configs:
      - targets: ['127.0.0.1:8888']
        labels:
          service: 'otel-collector'
          component: 'observability'
